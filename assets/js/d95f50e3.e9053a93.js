"use strict";(self.webpackChunkswiftui_realm_app=self.webpackChunkswiftui_realm_app||[]).push([[4833],{4137:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>d});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},g="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),g=p(n),h=r,d=g["".concat(l,".").concat(h)]||g[h]||u[h]||o;return n?a.createElement(d,i(i({ref:t},c),{},{components:n})):a.createElement(d,i({ref:t},c))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[g]="string"==typeof e?e:r,i[1]=s;for(var p=2;p<o;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},6038:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var a=n(7462),r=(n(7294),n(4137));const o={},i="Construct Search queries",s={unversionedId:"aggregations/search-stage",id:"aggregations/search-stage",title:"Construct Search queries",description:"You can construct Atlas Search queries with the $search aggregation pipeline stage.",source:"@site/docs/3-aggregations/1-search-stage.mdx",sourceDirName:"3-aggregations",slug:"/aggregations/search-stage",permalink:"/search-party-lab/docs/aggregations/search-stage",draft:!1,editUrl:"https://github.com/mongodb-developer/search-party-lab/blob/main/docs/3-aggregations/1-search-stage.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Aggregation pipelines",permalink:"/search-party-lab/docs/category/aggregation-pipelines"},next:{title:"Implementing Atlas Search",permalink:"/search-party-lab/docs/category/implementing-atlas-search"}},l={},p=[{value:"Aggregations in the Atlas UI",id:"aggregations-in-the-atlas-ui",level:2}],c=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",t)},g=c("Link"),u=c("Screenshot"),h={toc:p},d="wrapper";function m(e){let{components:t,...n}=e;return(0,r.kt)(d,(0,a.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"construct-search-queries"},"Construct Search queries"),(0,r.kt)("p",null,"You can construct Atlas Search queries with the ",(0,r.kt)("inlineCode",{parentName:"p"},"$search")," aggregation pipeline stage."),(0,r.kt)(g,{to:"https://mongodb.com/docs/manual/core/aggregation-pipeline",mdxType:"Link"},"MongoDB aggregation pipelines")," are multi-stage \u2018assembly lines\u2019 that reshape data and perform calculations. Pipelines can consist of one or more aggregation stages, performing different operations like match, group, sort, and output. For an exhaustive list of all available stages visit ",(0,r.kt)(g,{to:"https://mongodb.com/docs/manual/reference/operator/aggregation-pipeline/#std-label-aggregation-pipeline-operator-reference",mdxType:"Link"},"the complete list of pipeline operators"),".",(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"If you are not familiar with the aggregation pipelines, you should start with the ",(0,r.kt)("a",{parentName:"p",href:"https://mongodb-developer.github.io/aggregation-workshop/"},"Advanced Querying With Aggregation Pipelines"))),(0,r.kt)("p",null,"In this section, we'll build an aggregation pipeline with the ",(0,r.kt)("inlineCode",{parentName:"p"},"$search")," stage which performs full-text search using the Atlas Search index you just created."),(0,r.kt)("h2",{id:"aggregations-in-the-atlas-ui"},"Aggregations in the Atlas UI"),(0,r.kt)("p",null,"Navigate to the ",(0,r.kt)("strong",{parentName:"p"},"Collections")," tab of your database deployment, pick the ",(0,r.kt)("inlineCode",{parentName:"p"},"books")," collection, andn avigate to the ",(0,r.kt)("strong",{parentName:"p"},"Aggregation")," tab from the navbar under your collection details."),(0,r.kt)(u,{alt:"Aggregations tab highlighted on the collection details page",src:"img/screenshots/3-aggregations/1-search-stage/1-aggregation-tab.png",url:"https://cloud.mongodb.com",mdxType:"Screenshot"}),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"The Atlas UI can start feeling a bit cramp at this point. You can also use the aggregation pipeline builder in ",(0,r.kt)(g,{to:"https://www.mongodb.com/products/tools/compass",mdxType:"Link"},"Compass")," for a better experience.")),(0,r.kt)("p",null,"Click the ",(0,r.kt)("strong",{parentName:"p"},"Add Stage")," button and type ",(0,r.kt)("strong",{parentName:"p"},"$search")," in the ",(0,r.kt)("strong",{parentName:"p"},"select")," input."),(0,r.kt)(u,{alt:"Stage 1 of the pipeline with the $search stage selected",src:"img/screenshots/3-aggregations/1-search-stage/2-search-stage.png",url:"https://cloud.mongodb.com",mdxType:"Screenshot"}),(0,r.kt)("p",null,"Add the following code for the ",(0,r.kt)("inlineCode",{parentName:"p"},"$search")," stage."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'{\n    index: "fulltextsearch",\n    text: {\n        query: "cooking",\n        path: ["title"]\n    }\n}\n')),(0,r.kt)("p",null,'The stage uses the "fulltextsearch" index. You don\'t need to explicitly define the index if it\'s "default" but you can keep it for clarity.'),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"text"),' operator will search for "cooking" in the ',(0,r.kt)("inlineCode",{parentName:"p"},"title")," field. You should see a collection of documents returned on the right."),(0,r.kt)("p",null,"Click the ",(0,r.kt)("strong",{parentName:"p"},"Add Stage")," button, scroll down, and select ",(0,r.kt)("strong",{parentName:"p"},"$project")," for Stage 2."),(0,r.kt)(u,{alt:"Stage 2 of the pipeline with the $project stage selected",src:"img/screenshots/3-aggregations/1-search-stage/3-project-stage.png",url:"https://cloud.mongodb.com",mdxType:"Screenshot"}),(0,r.kt)("p",null,"Add the following implementation for the ",(0,r.kt)("inlineCode",{parentName:"p"},"$project")," stage to filter the returned fields."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"{\n  title: 1,\n  authors: 1,\n  genres: 1,\n  pages: 1\n}\n")),(0,r.kt)("p",null,"At this point, you should see similar results as what you did in the last section, as this is pretty much the same query."))}m.isMDXComponent=!0}}]);